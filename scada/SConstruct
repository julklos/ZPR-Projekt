import os

BUILD_DIR = "./build"
SRC_DIR = "./src"
INSTALL_DIR = "./install"
INCLUDE_DIR = "./include"
BINARY_NAME = "scada"
python3 = "/usr/include/python3.6"


# create object files in BUILD_DIR directory
VariantDir(BUILD_DIR, SRC_DIR, duplicate=0)
env = Environment(TARGET_ARCH='x86', CCFLAGS=["-Wall", "-shared", "-Wextra"])

# collect files for compilation
sources = [Glob(BUILD_DIR + '/*.cpp'), 
            Glob(BUILD_DIR + '/controllers/*.cpp'),
           Glob(BUILD_DIR + '/mappers/*.cpp'),
           Glob(BUILD_DIR + '/services/*.cpp')]

# collect include files
env.Append(CPPPATH= [
    INCLUDE_DIR,
    'libs/boost',
    'libs/pqxx/install',
    python3
])

# collect compiled libs
env.Append(LIBPATH = [
    'libs/boost',
    'libs/pqxx/install/lib'
])

# specify libraries
libs = [
    'boost_python3',
    'pqxx',
    'pq'
]

# make shared object
libs = env.SharedLibrary(target="scada", source=sources, LIBS=libs)
env.Default(libs)
